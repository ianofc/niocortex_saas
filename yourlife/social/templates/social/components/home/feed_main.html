{% load static %}

<div class="col-span-1 lg:col-span-6 w-full space-y-8">

    <div class="relative group">
        <div class="flex gap-4 overflow-x-auto pb-4 pt-1 px-1 scrollbar-hide snap-x" style="scrollbar-width: none; -ms-overflow-style: none;">
            
            <div class="flex-shrink-0 snap-start">
                <div class="w-24 h-40 md:w-32 md:h-52 relative rounded-[2rem] overflow-hidden cursor-pointer shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 group/story bg-white border border-white/50">
                    {% if request.user.avatar %}
                        <img src="{{ request.user.avatar.url }}" class="w-full h-full object-cover transition-transform duration-700 group-hover/story:scale-110 brightness-90">
                    {% else %}
                        <div class="w-full h-full bg-slate-100 flex items-center justify-center text-slate-300">
                            <i class="fas fa-user text-3xl"></i>
                        </div>
                    {% endif %}
                    
                    <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/80"></div>
                    
                    <div class="absolute bottom-3 left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-full">
                        <div class="w-9 h-9 rounded-full bg-indigo-600 text-white flex items-center justify-center shadow-lg ring-4 ring-indigo-600/30 group-hover/story:scale-110 transition-transform">
                            <i class="fas fa-plus"></i>
                        </div>
                        <span class="text-[11px] font-bold text-white tracking-wide mt-1 drop-shadow-md">Criar</span>
                    </div>
                </div>
            </div>

            {% for i in "12345" %} 
            <div class="flex-shrink-0 snap-start">
                <div class="w-24 h-40 md:w-32 md:h-52 relative rounded-[2rem] overflow-hidden cursor-pointer shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 ring-2 ring-transparent hover:ring-indigo-400 ring-offset-2 group/friend">
                    <img src="https://i.pravatar.cc/150?img={{ forloop.counter|add:15 }}" class="w-full h-full object-cover rounded-[2rem] transition-transform duration-700 group-hover/friend:scale-110">
                    <div class="absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-black/80"></div>
                    
                    <div class="absolute top-3 left-3 w-8 h-8 rounded-full border-2 border-white overflow-hidden shadow-sm">
                        <img src="https://i.pravatar.cc/150?img={{ forloop.counter|add:15 }}" class="w-full h-full object-cover">
                    </div>

                    <span class="absolute bottom-4 left-3 right-3 text-xs font-semibold text-white truncate text-shadow-md">Amigo {{ forloop.counter }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="bg-white/70 backdrop-blur-xl border border-white/60 rounded-[2rem] p-6 shadow-sm hover:shadow-md transition-all duration-500 relative overflow-hidden group">
        <div class="absolute top-0 right-0 w-64 h-64 bg-indigo-100/50 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none group-hover:bg-indigo-200/50 transition-colors"></div>

        <div class="relative z-10 flex gap-5">
            <div class="flex-shrink-0">
                {% if request.user.avatar %}
                    <img src="{{ request.user.avatar.url }}" class="w-12 h-12 rounded-full object-cover shadow-sm ring-2 ring-white">
                {% else %}
                    <div class="w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold border border-indigo-200 shadow-sm">
                        {{ request.user.first_name|first }}
                    </div>
                {% endif %}
            </div>
            
            <div class="flex-1 space-y-4">
                <div class="w-full bg-white/60 hover:bg-white border border-slate-200/60 hover:border-indigo-300 rounded-2xl px-5 py-4 transition-all cursor-text shadow-inner text-slate-500 hover:text-slate-800 text-lg font-medium flex items-center justify-between group/input"
                     onclick="document.getElementById('createPostModal').showModal()">
                    <span class="truncate">O que vocÃª estÃ¡ pensando?</span>
                    <i class="fas fa-pen-nib text-indigo-300 group-hover/input:text-indigo-500 transition-colors"></i>
                </div>

                <div class="flex items-center justify-between pt-2">
                    <div class="flex gap-1 md:gap-2">
                        <button class="flex items-center gap-2 px-3 py-2 rounded-xl text-slate-500 hover:bg-rose-50 hover:text-rose-600 transition-all text-sm font-semibold group/btn">
                            <i class="fas fa-video group-hover/btn:scale-110 transition-transform"></i> <span class="hidden md:inline">Live</span>
                        </button>
                        <button class="flex items-center gap-2 px-3 py-2 rounded-xl text-slate-500 hover:bg-emerald-50 hover:text-emerald-600 transition-all text-sm font-semibold group/btn">
                            <i class="fas fa-images group-hover/btn:scale-110 transition-transform"></i> <span class="hidden md:inline">MÃ­dia</span>
                        </button>
                        <button class="flex items-center gap-2 px-3 py-2 rounded-xl text-slate-500 hover:bg-amber-50 hover:text-amber-600 transition-all text-sm font-semibold group/btn">
                            <i class="far fa-smile group-hover/btn:scale-110 transition-transform"></i> <span class="hidden md:inline">Vibe</span>
                        </button>
                    </div>
                    <button class="bg-slate-900 hover:bg-black text-white px-6 py-2.5 rounded-xl text-sm font-bold shadow-lg shadow-slate-900/20 hover:scale-105 active:scale-95 transition-all">
                        Publicar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide py-2" x-data="{ feedFilter: 'all' }">
        <button @click="feedFilter = 'all'" 
                :class="feedFilter === 'all' ? 'bg-slate-800 text-white shadow-lg shadow-slate-800/20 scale-105' : 'bg-white/60 text-slate-600 hover:bg-white border border-white/50'"
                class="px-6 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap backdrop-blur-md">
            Tudo
        </button>
        <button @click="feedFilter = 'friends'" 
                :class="feedFilter === 'friends' ? 'bg-slate-800 text-white shadow-lg' : 'bg-white/60 text-slate-600 hover:bg-white border border-white/50'"
                class="px-6 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap backdrop-blur-md">
            Amigos
        </button>
        <button @click="feedFilter = 'school'" 
                :class="feedFilter === 'school' ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/30' : 'bg-white/60 text-slate-600 hover:bg-white border border-white/50'"
                class="px-6 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap backdrop-blur-md">
            Escola ðŸŽ“
        </button>
        <button @click="feedFilter = 'media'" 
                :class="feedFilter === 'media' ? 'bg-slate-800 text-white shadow-lg' : 'bg-white/60 text-slate-600 hover:bg-white border border-white/50'"
                class="px-6 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap backdrop-blur-md">
            MÃ­dia
        </button>
    </div>

    <div class="space-y-8 min-h-[500px]">
        {% for post in posts %}
            {% include 'social/feed/post_card.html' with post=post %}
        {% empty %}
            <div class="flex flex-col items-center justify-center py-20 text-center bg-white/40 backdrop-blur-md rounded-[2rem] border border-white/50 border-dashed group hover:border-indigo-300 transition-colors">
                <div class="w-24 h-24 bg-gradient-to-tr from-indigo-50 to-white rounded-full flex items-center justify-center mb-6 shadow-sm group-hover:scale-110 transition-transform duration-500">
                    <i class="fas fa-leaf text-4xl text-indigo-300"></i>
                </div>
                <h3 class="text-slate-800 font-bold text-xl mb-2">Tudo calmo por aqui</h3>
                <p class="text-slate-500 text-sm max-w-xs mx-auto leading-relaxed">
                    Seu feed estÃ¡ no "Modo Zen". Siga amigos ou compartilhe seu primeiro momento para comeÃ§ar a crÃ´nica.
                </p>
                <button class="mt-6 px-6 py-2 rounded-full bg-white text-indigo-600 font-bold text-sm shadow-sm hover:shadow-md transition-all hover:text-indigo-700">
                    Encontrar pessoas
                </button>
            </div>
        {% endfor %}
    </div>

</div>